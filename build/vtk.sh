. ./rc

PROJECT=vtk

mkdir -p $BUILD_DIR/$2
cd $BUILD_DIR/$2

#CMAKE_CXX_COMPILER=g++ CMAKE_CXX_FLAGS=-Wa,-mbig-obj added to pass assembler error too many sections

#-DVTK_MODULE_ENABLE_VTK_hdf5=NO added to resolve target collision
#-DVTK_MODULE_USE_EXTERNAL_VTK_glew=OFF since some strange Marefile generation

cmake \
	-G "MSYS Makefiles" \
	-DCMAKE_INSTALL_PREFIX=$INSTALL_DIR/$2 \
	-DCMAKE_BUILD_TYPE=$1 \
	-DBUILD_TESTING=OFF \
	-DCMAKE_CXX_COMPILER=g++ \
	-DCMAKE_C_COMPILER=gcc \
	-DCMAKE_CXX_FLAGS=-Wa,-mbig-obj \
	-DVTK_GROUP_ENABLE_Qt=YES \
	-DVTK_FORBID_DOWNLOADS=ON \
	-DVTK_MODULE_ENABLE_VTK_hdf5=NO \
	-DVTK_MODULE_ENABLE_VTK_PythonInterpretter=NO \
	-DVTK_MODULE_ENABLE_VTK_WrappingPythonCore=NO \
	-DVTK_MODULE_USE_EXTERNAL_VTK_eigen=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_expat=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_freetype=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_glew=OFF \
	-DVTK_MODULE_USE_EXTERNAL_VTK_hdf5=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_jpeg=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_jsoncpp=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_libxml2=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_lz4=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_lzma=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_png=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_tiff=ON \
	-DVTK_MODULE_USE_EXTERNAL_VTK_zlib=ON \
$SRC_DIR/$PROJECT \
&&
make -j$COMPILE_CORES \
&&
make install

cd $STUFF_ROOT_DIR